---
import { SEO } from "astro-seo";

import Navbar from "../components/navbar/Navbar.astro";
import Footer from "../components/footer/Footer.astro";
import { PersonalPhotoPath, getImageSrcForSocialPreview } from "../utils/image";
import { PersonalTitle, PersonalDescription } from "../data/presentation";
import { twitter } from "../data/socials";

import "@fontsource-variable/red-hat-mono";

import "../styles/colors.css";
import "../styles/utils.css";

interface Props {
  title?: string;
  description?: string;
  socialCard?: {
    type?: "website" | "article";
    image?: string;
    twitterType?: "summary" | "summary_large_image";
  };
}

const {
  title: titleProp,
  description: descriptionProp,
  socialCard: socialCardProp,
} = Astro.props;

const title = `${titleProp ? `${titleProp} | ` : ""}${PersonalTitle}`;
const description = descriptionProp ?? PersonalDescription;

const socialCard = {
  title,
  description,
  type: socialCardProp?.type ?? "website",
  image: new URL(
    await getImageSrcForSocialPreview(
      socialCardProp?.image ?? PersonalPhotoPath,
    ),
    Astro.site,
  ).href,
  twitterCard: socialCardProp?.twitterType ?? "summary",
};
---

<!doctype html>
<html lang="en" class="scroll-smooth">
  <head>
    <SEO
      title={title}
      description={description}
      openGraph={{
        basic: {
          title: socialCard.title,
          type: socialCard.type ?? "website",
          image: socialCard.image,
        },
        optional: {
          description: socialCard.description,
        },
      }}
      twitter={{
        creator: twitter.name,
        title: socialCard.title,
        image: socialCard.image,
        description: socialCard.description,
        card: socialCard.twitterCard,
      }}
    />

    <link rel="sitemap" href="/sitemap-index.xml" />

    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <meta name="generator" content={Astro.generator} />
  </head>
  <body class="min-w-[320px] bg-background font-mono text-text">
    <div class="!print:p-[0] mx-auto box-content max-w-screen px-4 md:px-8">
      <Navbar />
      <main>
        <slot />
      </main>
      <Footer />
    </div>
  </body>
</html>
